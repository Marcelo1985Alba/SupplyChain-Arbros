@page "/cargamaquina"
@using Syncfusion.Blazor.Buttons
@using Syncfusion.Blazor.Popups
@using Syncfusion.Blazor.Notifications
@using Syncfusion.Blazor.Inputs
@using Syncfusion.Blazor.Calendars
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.Lists
@using Syncfusion.Pdf;
@using Syncfusion.Pdf.Graphics;
@using Syncfusion.Pdf.Grid;
@using Syncfusion.Pdf.Tables;
@using Syncfusion.Blazor.SplitButtons
@using SupplyChain.Client.Pages.CDM

@using System.IO;
@using Syncfusion.Blazor.Gantt
@inject NavigationManager NavigationManager;
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@attribute [Authorize(Roles = "Administrador, Produccion")]
@inherits SupplyChain.Client.Pages.PCP.Carga_de_Maquina.CargaMaquinaBase

<div class="col-12 control-section mt-4">
    <SfToast ID="toast_default" @ref="ToastObj">
        <ToastPosition X="Center" Y="Top"></ToastPosition>
    </SfToast>
    <h3 class="card-title">Carga de Máquina</h3>
    <hr />
    <div class="row form-inline">
        <div class="col-2">
            <div>
                <SfNumericTextBox TValue="int" @bind-Value="@ordenAbuscar" Format="N0" ShowClearButton="true" Width="150"
                                  ShowSpinButton="false" Placeholder="Ingrese Nro de Orden de Fabricación" />
            </div>
        </div>
        <div class="col-4">
            <div>
                <SfButton IconCss="fa fa-folder-open" CssClass="btn btn-sm btn-info"
                          @onclick="BuscarOrden_Click">Abrir órden de fabricación</SfButton>
            </div>
        </div>
        <div class="col-2">
            <div>
                <SfProgressButton Content="Enviar OFs a DataCore"
                                  IconCss="fa fa-share-square" CssClass="btn btn-sm btn-info"
                                  @onclick="@(async()=> await EnviarCSVDataCore())">
                </SfProgressButton>
            </div>
        </div>
        <div class="col-2">
            @*<button class="" onclick="@(() => OpenExternalLink("https://aerre.grafana.net/public-dashboards/42c12fc6b1ad4c57b9ad51817fa6d364"))">Ver Panel</button>*@
             <div>
                <SfButton IconCss="" CssClass="btn btn-sm btn-info"
                          OnClick="OpenExternalLink">Ver Panel</SfButton>
            </div>
        </div>
        <div class="col-2">
            <div>
                <SfProgressButton Content="Refrescar"
                                  IconCss="fa fa-refresh" CssClass="btn btn-sm btn-info"
                                  @onclick="@(async()=> await Refrescar())">
                </SfProgressButton>
            </div>
        </div>
    </div>
    <SfSpinner @ref="SpinnerCDM" Size="60" Label="@MensajeCargando" CssClass="mt-5 pt-5"
               Type="SpinnerType.Bootstrap"
               @bind-Visible="Visible">
    </SfSpinner>
    <div class="row" id="cargaMaq">
        <div class="col">
            <div class="table-responsive">
                <table width="700" class="table table-bordered table-hover">
                    @if (dbCarga == null)
                    {
                        @*<p><em>Loading...</em></p>*@


                    }
                    else
                    {
                        <thead>
                            @*Fechas del calendario*@
                            <tr class="CargaRowClass" style="height:20px">
                                <td class="CargaCellClass" style="min-width: 40px;" />
                                <td class="CargaCellClass" style="min-width: 200px;" />
                                @{bool xDiaLaboral;
                                    totalDiasNoLaborables = 0;}
                                @for (int x = 0; x < extensionDias; x++)
                                {
                                    string xCultureDayName = System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.GetDayName(fechaInicial.AddDays(x).DayOfWeek);
                                    if ((xCultureDayName.ToLower() == "sábado" || xCultureDayName.ToLower() == "saturday") && !sabadosLaborables)
                                    {
                                        xDiaLaboral = false;
                                        totalDiasNoLaborables++;
                                    }
                                    else if ((xCultureDayName.ToLower() == "domingo" && xCultureDayName.ToLower() != "sunday") && !domingosLaborables)
                                    {
                                        xDiaLaboral = false;
                                        totalDiasNoLaborables++;
                                    }
                                    else if (dbDiasFestivos.Where(z => z.ID == fechaInicial.AddDays(x).ToString("yyyMMdd")).ToList().Count > 0)
                                    {
                                        xDiaLaboral = false;
                                    }
                                    else
                                    {
                                        xDiaLaboral = true;
                                    }

                                    if (xDiaLaboral)
                                    {
                                        <td class="CargaCellClass"
                                            colspan="@CantidadColumnasPorPeriodo"
                                            style="border-left: solid;
                                            border-left-width: thin;
                                            border-left-color:lightgray;">
                                            <a style="font-size:12px">&nbsp;&nbsp;@(xCultureDayName + " " + fechaInicial.AddDays(x).Day.ToString() + " " + fechaInicial.AddDays(x).ToString("MMMM") + " " + fechaInicial.AddDays(x).ToString("yy"))</a>
                                        </td>
                                    }
                                }
                            </tr>
                            @*Horas del calendario*@
                            <tr class="CargaRowClass" style="height:20px">
                                <td class="CargaCellClass" colspan="2"
                                    style="
                                    border-bottom: solid;
                                    border-bottom-width:thin;
                                    border-bottom-color:lightgray;
                                    border-color:lightgray;
                                    border-width:1px;">
                                    <a style="font-size:12px">CELDA</a>
                                </td>
                                @{xHora = 1;}
                                @for (int x = 1; x <= (extensionDias - totalDiasNoLaborables) * CantidadColumnasPorPeriodo; x++)
                                {
                                    <td class="CargaCellClass"
                                        style="
                                border-left: solid;
                                border-bottom: solid;
                                border-left-width: thin;
                                border-bottom-width:thin;
                                border-left-color:lightgray;
                                border-bottom-color:lightgray;
                                border-color:lightgray;
                                border-width:1px;
                                text-align:center;
                                min-width:60px;">
                                        <a style="font-size:12px">@xHora</a>
                                    </td>
                                    xHora++;
                                    if (xHora > CantidadColumnasPorPeriodo)
                                    {
                                        xHora = 1;
                                    }
                                }
                            </tr>
                            
                        </thead>
                        <tbody>
                            @*Dibuja barras*@
                            @{int i = 0;}
                            @while (i < dbCarga.Count)
                            {
                                <tr class="CargaRowClass">
                                    @*CG_CELDA*@
                                    <td class="CargaCellClass">
                                        <a href="Abms/celdas" target="_blank" class="CargaHyperLink">
                                            @dbCarga[i].CG_CELDA
                                        </a>
                                        

                                    </td>
                                    @*DES_CELDA*@
                                    <td class="CargaCellClass" style="min-width:200px;border-right: solid;
                                border-right-width: thin;
                                border-right-color:lightgray;">
                                        <a href="Abms/celdas" target="_blank"
                                           class="CargaHyperLink">
                                            @dbCarga[i].DES_CELDA
                                        </a>
                                    </td>

                                    @*recorre en el while mientras sea la misma celda*@
                                    @{
                                        xCg_celda = dbCarga[i].CG_CELDA.Trim();
                                        xColumna = 2;
                                        xHora = 1;
                                    }
                                    @while (i < dbCarga.Count && xCg_celda == dbCarga[i].CG_CELDA.Trim())
                                    {
                                        xColumnaInicialBarra = Convert.ToInt16(dbCarga[i].COLUMNA);
                                        for (int x = xColumna; x < xColumnaInicialBarra; x++)
                                        {
                                            @*Celda en blanco*@
                                            if (xHora == 1)
                                            {
                                                <td class="CargaCellClass" style="border-left: solid;
                                                            border-left-width: thin;
                                                            border-left-color:lightgray;" />                                                

                                            }
                                            else
                                            {
                                                <td class="CargaCellClass" />
                                            }
                                            xColumna++;
                                            xHora++;
                                            if (xHora > CantidadColumnasPorPeriodo)
                                            {
                                                xHora = 1;
                                            }
                                        }
                                        <td class="CargaCellClass" colspan="@dbCarga[i].COLUMNSPAN">
                                            
                                            @{
                                                int xOrdenFabricacion = dbCarga.ElementAt(i).CG_ORDF;
                                                bool xExigeOA = dbCarga.ElementAt(i).EXIGEOA;
                                                int xPedido = dbCarga.ElementAt(i).PEDIDO;
                                                string xCgProd = dbCarga.ElementAt(i).CG_PROD;
                                                decimal xCantidad = dbCarga.ElementAt(i).CANT;
                                                ModeloCarga xCarga = dbCarga.ElementAt(i);
                                                OrdenDeFabAlta = dbCarga.Where(t => t.CG_ORDFASOC == dbCarga.ElementAt(i)
                                                    .CG_ORDFASOC).OrderByDescending(t => t.CG_ORDF).FirstOrDefault().CG_ORDF;
                                            }

                                            <SfTooltip CssClass="e-tooltip-css" OpensOn="Hover" 
                                                       Target="@(".botonOrden" + xOrdenFabricacion.ToString())" 
                                                       Width="300" Height="160" MouseTrail=true>
                                                    <TooltipTemplates>
                                                        <Content>
                                                            <div id='democontent' class='democontent'>
                                                                <div class='info'>
                                                                    <div style='margin-top:0px;font-size:13px'>
                                                                        @{

                                                                            if (xCarga.EXIGEOA == false)
                                                                            {
                                                                                <label class="label" style="font-size:16px">
                                                                                    @xCarga.CG_PROD.Trim()
                                                                                </label>
                                                                                <br />
                                                                                <label class="label" style="font-size:16px">
                                                                                    @xCarga.DES_PROD.Trim()
                                                                                </label>
                                                                                <br />
                                                                                <label class="label" style="font-size:16px">
                                                                                    <a class="font-weight-bold">Cantidad: </a>@(Decimal.ToInt32(xCarga.CANT))<br />
                                                                                </label>
                                                                                <br />
                                                                                <label class="label" style="font-size:16px">
                                                                                    <a class="font-weight-bold">OF Inicial: </a>@xCarga.CG_ORDFASOC
                                                                                </label>
                                                                                <br />
                                                                                <label class="label" style="font-size:16px">
                                                                                <a class="font-weight-bold">OF Alta: </a>@dbCarga.Where(t => t.CG_ORDFASOC == xCarga.CG_ORDFASOC).OrderByDescending(t => t.CG_ORDF).FirstOrDefault().CG_ORDF
                                                                                </label>
                                                                                <br />
                                                                                <label class="label" style="font-size:16px">
                                                                                    @xCarga.PROCESO.Trim()
                                                                                </label>
                                                                            }
                                                                            else
                                                                            {
                                                                                <label class="label" style="font-size:18px">
                                                                                    <a class="font-weight-bold">Pedido: </a>@xCarga.PEDIDO
                                                                                </label>
                                                                                <label class="label" style="font-size:16px">
                                                                                    @xCarga.DES_CLI.Trim()
                                                                                </label>
                                                                                <br />
                                                                                <label class="label" style="font-size:16px">
                                                                                    @xCarga.CG_PROD.Trim()
                                                                                </label>
                                                                                <br />
                                                                                <label class="label" style="font-size:16px">
                                                                                    @xCarga.DES_PROD.Trim()
                                                                                </label>
                                                                                <br />
                                                                                <label class="label" style="font-size:16px">
                                                                                    @xCarga.PROCESO.Trim()
                                                                                </label>
                                                                            }
                                                                        }
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </Content>
                                                    </TooltipTemplates>
                                                </SfTooltip>

                                            @{
                                                int ValorBoton;
                                                if (dbCarga[i].EXIGEOA)
                                                {
                                                    ValorBoton = dbCarga[i].PEDIDO;
                                                }
                                                else
                                                {
                                                    ValorBoton = OrdenDeFabAlta;
                                                }
                                            }
                                            <div class="@("botonOrden" + xOrdenFabricacion.ToString())" id="ButtonHover">
                                                <input type="button"
                                                       class="CargaButtonClass@((dbCarga.ElementAt(i).CG_ORDF == ordenAbuscar || (dbCarga.ElementAt(i).PEDIDO == ordenAbuscar && dbCarga.ElementAt(i).PEDIDO != 0)) ? " CargaButtonClassBuscarOrden" : ((dbCarga.ElementAt(i).BORDE) ? " CargaButtonClassFirstFirme" : ""))"
                                                       @onclick=@(async() => await OrdenFabricacionOpen(xOrdenFabricacion, xExigeOA, xPedido, xCgProd, xCantidad))
                                                       style="width: 100%;background-image: linear-gradient( @dbCarga[i].BACKGROUND.ToLower(), whitesmoke)"
                                                       value="@ValorBoton"
                                                       id="of + @dbCarga[i].CG_ORDF" />
                                            </div>
                                        </td>
                                        xColumna = xColumna + dbCarga[i].COLUMNSPAN;
                                        xHora = xHora + dbCarga[i].COLUMNSPAN;
                                        if (xHora > 8)
                                        {
                                            xHora = 0 + dbCarga[i].COLUMNSPAN;
                                        }
                                        i++;
                                    }
                                </tr>
                            }
                        </tbody>
                    }
                </table>
            </div>
        </div>

    </div>


    <!--<div class="col-lg-12 control-section">
        <div class="content-wrapper">
            <div class="row">
                <SfGantt DataSource="@dbCarga" Height="450px" Width="100%" HighlightWeekends="true"
                         Toolbar="@(new List<string>(){ "Add", "Edit", "Update", "Delete", "Cancel", "ExpandAll", "CollapseAll"})"
                         AllowSelection="true" GridLines="Syncfusion.Blazor.Gantt.GridLine.Both" TreeColumnIndex="1"
                         ProjectStartDate="@fechaInicial" ProjectEndDate="@fechaInicial.AddDays(extensionDias)">
                    <GanttTaskFields Id="CG_ORDF" Name="CG_ORDF" StartDate="FE_CURSO"
                                     EndDate="EndDate" Duration="COLSPAN">

                    </GanttTaskFields>
                    <GanttEditSettings AllowAdding="true" AllowDeleting="true" AllowEditing="true"
                                       AllowTaskbarEditing="true" ShowDeleteConfirmDialog="true">

                    </GanttEditSettings>
                    <GanttColumns>-->
    @*<GanttColumn Field="TaskId" Width="100"></GanttColumn>*@
    <!--<GanttColumn Field="CG_ORDF" HeaderText="Ord. Fab." Width="50"></GanttColumn>
    <GanttColumn Field="CG_CELDA" HeaderText="Cod. Celda" Width="50"></GanttColumn>
    <GanttColumn Field="DES_CELDA" HeaderText="Celda" Width="100"></GanttColumn>-->
    @*<GanttColumn Field="Duration"></GanttColumn>
        <GanttColumn Field="Progress"></GanttColumn>
        <GanttColumn Field="Predecessor"></GanttColumn>*@
    <!--</GanttColumns>
                    <GanttLabelSettings>
                        <LeftLabelTemplate>
                            <div class="e-left-label-inner-div" style="height:22px;margin-top:7px;">
                                <span class="e-label">@((context as ModeloCarga).CG_ORDF)</span>
                            </div>
                        </LeftLabelTemplate>
                    </GanttLabelSettings>
                    <GanttTimelineSettings>
                        <GanttTopTierSettings Unit="TimelineViewMode.Week" Format="MMM dd, y"></GanttTopTierSettings>
                        <GanttBottomTierSettings Unit="TimelineViewMode.Day"></GanttBottomTierSettings>
                    </GanttTimelineSettings>
                </SfGantt>
            </div>
        </div>
    </div>-->
    @*DIALOG ORDEN DE FABRICACION*@
    @if (isOrdenDialogVisible && ordenFabricacion != null && dbCarga != null)
    {
        <div id="targetPreguntaFoto" class="cssOrdenFabricacionDialog">
            <SfDialog AllowDragging="true" Target="#cargaMaq" CssClass="" IsModal="false"
                      ShowCloseIcon="true" CloseOnEscape="true" Height="500" Width="900"
                      @bind-Visible="@isOrdenDialogVisible">
                <DialogTemplates>
                    <Header><div class="e-dlg-header-titulo">@ordenTitulo - Cantidad: @(Decimal.ToInt32(ordenFabricacion.CANT))</div></Header>
                    <Content>
                        @if (ordenFabricacionEncabezado != null)
                        {
                            <div>
                                @*INFORMACION GENERAL*@
                                <div class="form-row">
                                    <div class="form-group col-md-6" style="text-align:left">
                                        @if (ordenFabricacion.EXIGEOA == true)
                                        {
                                            <label class="font-weight-normal"><a class="font-weight-bold">Fecha de Entrega: </a>@ordenFabricacionEncabezado.ENTRPREV.ToShortDateString()</label>
                                        }
                                        else
                                        {
                                            <label class="font-weight-normal"><a class="font-weight-bold">Fecha de Entrega: </a>@ordenFabricacion.FE_ENTREGA</label>
                                        }
                                    </div>
                                    @if (ordenFabricacion.EXIGEOA == true)
                                    {
                                        <div class="form-group col-md-6" style="text-align:left">
                                            <label class="font-weight-normal"><a class="font-weight-bold">Cliente: </a>@(ordenFabricacionEncabezado.CG_CLI + " - " + ordenFabricacionEncabezado.DES_CLI)</label>
                                        </div>
                                    }
                                </div>
                                <hr class="separator">
                                @*PARAMETROS MODIFICABLES*@
                                <div class="form-row">
                                    <div class="form-group col-md-4">
                                        @{
                                            if (ordenFabricacion.CG_CELDA == "BE3")
                                            {
                                                <div>
                                                    <label style="color:blue">Operario:</label>
                                                </div>
                                                <SfComboBox TValue="string" TItem="Operario" PopupWidth="auto" AllowFiltering="true"
                                                            @bind-Value="@ordenFabricacion.DES_OPER" DataSource="@operariosBE3">
                                                    <ComboBoxFieldSettings Value="DES_OPER" Text="DES_OPER"></ComboBoxFieldSettings>
                                                    <ComboBoxTemplates TItem="Operario">
                                                        <HeaderTemplate>
                                                            <table><tr><th class="e-text-center combo-width">Código</th><th>Operario</th></tr></table>
                                                        </HeaderTemplate>
                                                        <ItemTemplate>
                                                            <table>
                                                                <tbody>
                                                                    <tr>
                                                                        <td class="e-text-center combo-width">@((context as Operario).CG_OPER)</td>
                                                                        <td>@((context as Operario).DES_OPER)</td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </ItemTemplate>
                                                    </ComboBoxTemplates>
                                                </SfComboBox>
                                            }
                                            else
                                            {
                                                <div>
                                                    <label style="color:blue">Operario:</label>
                                                </div>
                                                <SfComboBox TValue="string" TItem="Operario" PopupWidth="auto" AllowFiltering="true"
                                                            @bind-Value="@ordenFabricacion.DES_OPER" DataSource="@operariosList">
                                                    <ComboBoxFieldSettings Value="DES_OPER" Text="DES_OPER"></ComboBoxFieldSettings>
                                                    <ComboBoxTemplates TItem="Operario">
                                                        <HeaderTemplate>
                                                            <table><tr><th class="e-text-center combo-width">Código</th><th>Operario</th></tr></table>
                                                        </HeaderTemplate>
                                                        <ItemTemplate>
                                                            <table><tbody><tr><td class="e-text-center combo-width">@((context as Operario).CG_OPER)</td><td>@((context as Operario).DES_OPER)</td></tr> </tbody></table>
                                                        </ItemTemplate>
                                                    </ComboBoxTemplates>
                                                </SfComboBox>
                                            }
                                        }
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label style="color:blue">Celda:</label>
                                        <SfComboBox TValue="string" TItem="ModeloGenericoStringString" PopupWidth="auto" AllowFiltering="true"
                                                    @bind-Value="@ordenFabricacion.CG_CELDA" DataSource="@dbCeldas">
                                            <ComboBoxFieldSettings Value="ID" Text="TEXTO"></ComboBoxFieldSettings>
                                            <ComboBoxTemplates TItem="ModeloGenericoStringString">
                                                <HeaderTemplate>
                                                    <table><tr><th class="e-text-center combo-width">Código</th><th>Celda</th></tr></table>
                                                </HeaderTemplate>
                                                <ItemTemplate>
                                                    <table>
                                                        <tbody>
                                                            <tr>
                                                                <td class="e-text-center combo-width">
                                                                    @((context as ModeloGenericoStringString).ID)
                                                                </td>
                                                                <td>@((context as ModeloGenericoStringString).TEXTO)</td>]
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </ItemTemplate>
                                            </ComboBoxTemplates>
                                        </SfComboBox>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <div>
                                            <label style="color:blue">Proceso:</label>
                                        </div>
                                        <SfComboBox TValue="string" TItem="ModeloGenericoStringString" PopupWidth="auto" AllowFiltering="true"
                                                    @bind-Value="@ordenFabricacion.PROCESO" DataSource="@dbProcesos">
                                            <ComboBoxFieldSettings Value="ID" Text="TEXTO"></ComboBoxFieldSettings>
                                            <ComboBoxTemplates TItem="ModeloGenericoStringString">
                                                <HeaderTemplate>
                                                    <table><tr><th class="e-text-center combo-width">Código</th><th>Proceso</th></tr></table>
                                                </HeaderTemplate>
                                                <ItemTemplate>
                                                    <table><tbody><tr><td class="e-text-center combo-width">@((context as ModeloGenericoStringString).ID)</td><td>@((context as ModeloGenericoStringString).TEXTO)</td></tr> </tbody></table>
                                                </ItemTemplate>
                                            </ComboBoxTemplates>
                                        </SfComboBox>
                                    </div>
                                </div>
                                <div class="form-row">
                                    @*<div class="form-group col-md-2">
                                            <label style="color:blue">Planificada Inicio:</label>
                                            <SfDateTimePicker Format="dd/MM/yyyy" TValue="DateTime" @bind-Value="@ordenFabricacion.FECHA_PREVISTA_FABRICACION"></SfDateTimePicker>
                                        </div>*@
                                    <div class="form-group col-md-3">
                                        <label style="color:blue">Inicio real:</label>
                                        <SfDateTimePicker TValue="DateTime" @bind-Value="@ordenFabricacion.FECHA_INICIO_REAL_FABRICACION"></SfDateTimePicker>
                                    </div>
                                    <div class="form-group col-md-3">
                                        <label style="color:blue">Finalización real:</label>
                                        <SfDateTimePicker TValue="DateTime?" @bind-Value="@ordenFabricacion.FE_CIERRE"></SfDateTimePicker>
                                    </div>
                                    <div class="form-group col-md-2">
                                        <label style="color:blue">Cantidad fabricada:</label>
                                        <SfNumericTextBox TValue="decimal" Format="N0" @bind-Value="@ordenFabricacion.CANTFAB" ShowClearButton="true" Step="1"></SfNumericTextBox>
                                    </div>
                                    <div class="form-group col-md-2">
                                        <label style="color:blue">Seleccione Acción:</label>
                                        <SfDropDownList TValue="int" TItem="ModeloGenericoIntString" @bind-Value="@ordenFabricacion.CG_ESTADOCARGA" DataSource="@dbEstadoCarga">
                                            <DropDownListFieldSettings Value="ID" Text="TEXTO"></DropDownListFieldSettings>
                                        </SfDropDownList>
                                    </div>
                                    <div class="form-group col-md-2">
                                        <label style="color:blue">Dependencia:</label>
                                        <SfDropDownList TValue="int" TItem="ModeloGenericoIntString" @bind-Value="@ordenFabricacion.CG_ORDFORIG" DataSource="@dbOrdenesDependientes">
                                            <DropDownListFieldSettings Value="ID" Text="TEXTO"></DropDownListFieldSettings>
                                        </SfDropDownList>
                                    </div>
                                </div>
                            </div>
                            <hr class="separator">
                            @*BOTONES PARA OBTENER DATOS*@
                            <div class="form-row">
                                <div class="form-group col">
                                    <SfButton Content="Ver Plano" IsPrimary="true" IconCss="fa fa-file-pdf-o"
                                              @onclick="@(async ()=> await VerPlano())"></SfButton>
                                </div>
                                @*<div class="form-group col">
                                        <SfButton Content="Ver Plano" IsPrimary="true" IconCss="fa fa-file-pdf-o"
                                                  @onclick="@(async ()=> await VerPlano(ordenFabricacion.CG_PROD))"></SfButton>
                                    </div>*@
                                @if (ordenFabricacion.EXIGEOA == true)
                                {
                                    <div class="form-group col">
                                        <Syncfusion.Blazor.SplitButtons.SfProgressButton IsPrimary="true" IconCss="fa fa-save"
                                                                                         Content="Guardar Datos"
                                                                                         @onclick="@(async ()=> await DownloadText())">

                                        </Syncfusion.Blazor.SplitButtons.SfProgressButton>


                                    </div>
                                }
                                @if (ordenFabricacion.CG_PROD.Substring(0, 4) == "0012" ||
                                 ordenFabricacion.CG_PROD.Substring(0, 5) == "00130" ||
                                 ordenFabricacion.CG_PROD.Substring(0, 5) == "00131")
                                {
                                    <div class="form-group col">
                                        <SfButton IsPrimary="true" Content="Ver en Modulo Servicios"
                                                  @onclick="@(async ()=> await IrAServicio(ordenFabricacion.PEDIDO.ToString().Trim()))"></SfButton>
                                    </div>
                                }
                                <div class="form-group col">
                                    <Syncfusion.Blazor.SplitButtons.SfProgressButton IsPrimary="true" IconCss="fa fa-download"
                                                                                     Content="Identificación"
                                                                                     @onclick="@(async ()=> await Etiqueta())">

                                    </Syncfusion.Blazor.SplitButtons.SfProgressButton>
                                </div>
                                @if (ordenFabricacion.EXIGEOA == true)
                                {
                                    <div class="form-group col">
                                        <SfButton IsPrimary="true" IconCss="fa fa-file"
                                                  @onclick="@(async ()=> await Ensayos(ordenFabricacion.PEDIDO.ToString().Trim()))">Ver Ensayos</SfButton>
                                    </div>
                                }
                                @if (!ordenFabricacion.EXIGEOA == true)
                                {

                                    <div class="form-group col">
                                        <SfButton IsPrimary="true" IconCss="fa fa-file"
                                                  @onclick="@(async ()=> await IrAPrograma(ordenFabricacion.CG_PROD.Trim()))">
                                            Ver Programa
                                        </SfButton>
                                    </div>
                                }
                                <div class="form-group col">
                                    <SfButton IsPrimary="true" IconCss="fa fa-file"
                                              @onclick="@(async ()=> await AbreEvento())">
                                        Cargar Evento
                                    </SfButton>
                                </div>
                            </div>

                            <hr class="separator">
                            @*PRODUCTO*@
                            <div>
                                <div class="form-row">
                                    <div class="form-group col-md-4" style="text-align:left">
                                        <label class="font-weight-normal"><a class="font-weight-bold">Código: </a>@ordenFabricacion.CG_PROD</label>
                                    </div>
                                    <div class="form-group col-md-4" style="text-align:left">
                                        <label class="font-weight-normal"><a class="font-weight-bold">Descripción: </a>@ordenFabricacion.DES_PROD</label>
                                    </div>
                                    <div class="form-group col-md-2" style="text-align:left">
                                        <label class="font-weight-normal"><a class="font-weight-bold">Cantidad: </a>@ordenFabricacion.CANT</label>
                                    </div>
                                    <div class="form-group col-md-2" style="text-align:left">
                                        <label class="font-weight-normal"><a class="font-weight-bold">Avance: </a>@(ordenFabricacion.AVANCE.ToString() + " %")</label>
                                    </div>
                                </div>
                            </div>
                            <hr class="separator">
                            @*CAMPOS PERSONALIZADOS DE PEDCLI*@
                            @if (ordenFabricacion != null)
                            {
                                @if (ordenFabricacion.PEDIDO > 0)
                                {
                                    <div>
                                        <div class="form-row">
                                            <div class="form-group col-md-4" style="text-align:left">
                                                <label class="font-weight-normal"><a class="font-weight-bold">@ordenFabricacionEncabezado.TITULO_CAMPOCOM1: </a>@ordenFabricacionEncabezado.CAMPOCOM1</label>
                                            </div>
                                            <div class="form-group col-md-4" style="text-align:left">
                                                <label class="font-weight-normal"><a class="font-weight-bold">@ordenFabricacionEncabezado.TITULO_CAMPOCOM2: </a>@ordenFabricacionEncabezado.CAMPOCOM2</label>
                                            </div>
                                            <div class="form-group col-md-4" style="text-align:left">
                                                <label class="font-weight-normal"><a class="font-weight-bold">@ordenFabricacionEncabezado.TITULO_CAMPOCOM3: </a>@ordenFabricacionEncabezado.CAMPOCOM3</label>
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group col-md-4" style="text-align:left">
                                                <label class="font-weight-normal"><a class="font-weight-bold">@ordenFabricacionEncabezado.TITULO_CAMPOCOM4: </a>@ordenFabricacionEncabezado.CAMPOCOM4</label>
                                            </div>
                                            <div class="form-group col-md-4" style="text-align:left">
                                                <label class="font-weight-normal"><a class="font-weight-bold">@ordenFabricacionEncabezado.TITULO_CAMPOCOM5: </a>@ordenFabricacionEncabezado.CAMPOCOM5</label>
                                            </div>
                                            <div class="form-group col-md-4" style="text-align:left">
                                                <label class="font-weight-normal"><a class="font-weight-bold">@ordenFabricacionEncabezado.TITULO_CAMPOCOM6: </a>@ordenFabricacionEncabezado.CAMPOCOM6</label>
                                            </div>
                                        </div>
                                    </div>
                                    <hr class="separator">
                                    <div>
                                        <div class="form-row">
                                            <div class="form-group col-md-12" style="text-align:left">
                                                <label class="font-weight-normal"><a class="font-weight-bold">OBSERVACIONES: </a>@ordenFabricacionEncabezado.OBSERITEM</label>
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                            @*INFORMACION GENERAL*@
                            <div>
                                @if (ordenFabricacion.EXIGEOA == true)
                                {
                                    <div class="form-row">
                                        <div class="form-group col-md-6" style="text-align:left">
                                            <label class="font-weight-normal">
                                                <a class="font-weight-bold">Transportista: </a>
                                                @(ordenFabricacionEncabezado.CG_TRANS + " - " + ordenFabricacionEncabezado.DES_TRANS)
                                            </label>
                                        </div>
                                        <div class="form-group col-md-6" style="text-align:left">
                                            <label class="font-weight-normal">
                                                <a class="font-weight-bold">Entrega: </a>
                                                @(ordenFabricacionEncabezado.DIRENT + " - " + ordenFabricacionEncabezado.DIRTRANS)
                                            </label>
                                        </div>
                                    </div>
                                }
                            </div>
                            <hr class="separator">
                        }
                        <table width="100%">
                            <tbody>
                                <tr>
                                    <td style="vertical-align:top">
                                        @*ENCABEZADO*@
                                        @if (ordenFabricacionEncabezado != null)
                                        {
                                            <div class="form-group" style="margin-left:50px;margin-right:50px">
                                                <table width="100%">
                                                    @*MATERIAS PRIMAS*@
                                                    @if (ordenFabricacionMP != null)
                                                    {
                                                        @if (ordenFabricacionMP.Count > 0)
                                                        {
                                                            <tr style="font-weight:bold">
                                                                <td colspan="2">
                                                                    <a @onclick="@(()=> verMP = !verMP)">MATERIAS PRIMAS</a>
                                                                </td>
                                                            </tr>
                                                            if (verMP)
                                                            {
                                                                <tr>
                                                                    <td colspan="2">
                                                                        <table width="100%">
                                                                            <tr class="font-weight-bold">
                                                                                <td width="15%" style="border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Código</label>
                                                                                </td>
                                                                                <td style="margin-left:10px;white-space:nowrap;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Descripción</label>
                                                                                </td>
                                                                                <td width="10%" style="margin-left:10px;text-align:right;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Cantidad</label>
                                                                                </td>
                                                                                <td width="10%" style="margin-left:10px;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Lote</label>
                                                                                </td>
                                                                                <td width="10%" style="margin-left:10px;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Identific</label>
                                                                                </td>
                                                                                @if (ordenFabricacion.EXIGEOA)
                                                                                {
                                                                                    <td width="10%" style="margin-left:10px;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                        <label>Serie</label>
                                                                                    </td>
                                                                                }
                                                                            </tr>
                                                                            @foreach (ModeloOrdenFabricacionMP xMP in ordenFabricacionMP)
                                                                            {
                                                                                <tr>
                                                                                    <td>
                                                                                        <label>@xMP.CG_ART</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xMP.DES_ART</label>
                                                                                    </td>
                                                                                    <td style="text-align:right">
                                                                                        <label>@xMP.STOCK</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xMP.LOTE</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xMP.DESPACHO</label>
                                                                                    </td>
                                                                                    @if (ordenFabricacion.EXIGEOA)
                                                                                    {
                                                                                        <td>
                                                                                            <label>@xMP.SERIE</label>
                                                                                        </td>
                                                                                    }
                                                                                </tr>
                                                                            }
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            }

                                                        }
                                                    }
                                                    @*SEMI ELABORADOS*@
                                                    @if (ordenFabricacionSE != null)
                                                    {
                                                        @if (ordenFabricacionSE.Count > 0)
                                                        {
                                                            <tr style="font-weight:bold">
                                                                <td colspan="2">
                                                                    <a @onclick="@(()=> verSE = !verSE)">SEMI ELABORADOS</a>
                                                                </td>
                                                            </tr>
                                                            if (verSE)
                                                            {
                                                                <tr>
                                                                    <td colspan="2">
                                                                        <table width="100%">
                                                                            <tr class="font-weight-bold">
                                                                                <td width="15%" style="border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Código</label>
                                                                                </td>
                                                                                <td style="margin-left:10px;white-space:nowrap;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Descripción</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;text-align:right;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Cantidad</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Lote</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;text-align:right;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Línea</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Ubicación</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Despacho</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;text-align:right;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Vale</label>
                                                                                </td>
                                                                            </tr>
                                                                            @foreach (ModeloOrdenFabricacionSE xSE in ordenFabricacionSE)
                                                                            {
                                                                                <tr>
                                                                                    <td>
                                                                                        <label>@xSE.CG_ART</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xSE.DES_ART</label>
                                                                                    </td>
                                                                                    <td style="text-align:right">
                                                                                        <label>@xSE.STOCK</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xSE.LOTE</label>
                                                                                    </td>
                                                                                    <td style="text-align:right">
                                                                                        <label>@xSE.CG_LINEA</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xSE.UBICACION</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xSE.DESPACHO</label>
                                                                                    </td>
                                                                                    <td style="text-align:right">
                                                                                        <label>@xSE.VALE</label>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            }

                                                        }
                                                    }
                                                    @*HOJA DE RUTA*@
                                                    @if (ordenFabricacionHojaRuta != null)
                                                    {
                                                        @if (ordenFabricacionHojaRuta.Count > 0)
                                                        {
                                                            <tr style="font-weight:bold">
                                                                <td colspan="2">
                                                                    <a @onclick="@(()=> verHojaRuta = !verHojaRuta)">HOJA DE RUTA</a>
                                                                </td>
                                                            </tr>
                                                            if (verHojaRuta)
                                                            {
                                                                <tr>
                                                                    <td colspan="2">
                                                                        <table width="100%">
                                                                            <tr class="font-weight-bold">
                                                                                <td width="5%" style="text-align:center;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Órden</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Proceso</label>
                                                                                </td>
                                                                                <td style="margin-left:10px;white-space:nowrap;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Descripción</label>
                                                                                </td>
                                                                                <td width="8%" style="border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Celda</label>
                                                                                </td>
                                                                                <td style="margin-left:10px;white-space:nowrap;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Descripción</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;text-align:right;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Tiempo</label>
                                                                                </td>
                                                                                <td width="5%" style="margin-left:10px;text-align:center;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Proporc</label>
                                                                                </td>
                                                                                <td width="8%" style="margin-left:10px;text-align:right;border-top:solid;border-top-color:lightgray;border-top-width:0.2px;border-bottom:solid;border-bottom-color:lightgray;border-bottom-width:0.2px">
                                                                                    <label>Tiempo Unitario</label>
                                                                                </td>
                                                                            </tr>
                                                                            @foreach (ModeloOrdenFabricacionHojaRuta xHojaRuta in ordenFabricacionHojaRuta)
                                                                            {
                                                                                <tr>
                                                                                    <td style="text-align:center">
                                                                                        <label>@xHojaRuta.ORDEN</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xHojaRuta.PROCESO</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xHojaRuta.DESCRIP</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xHojaRuta.CG_CELDA</label>
                                                                                    </td>
                                                                                    <td>
                                                                                        <label>@xHojaRuta.DES_CELDA</label>
                                                                                    </td>
                                                                                    <td style="text-align:right">
                                                                                        <label>@xHojaRuta.TIEMPO_TOTAL</label>
                                                                                    </td>
                                                                                    <td style="text-align:center">
                                                                                        <label>@xHojaRuta.PROPORC</label>
                                                                                    </td>
                                                                                    <td style="text-align:right">
                                                                                        <label>@xHojaRuta.TIEMPO1</label>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            }

                                                        }
                                                    }
                                                </table>
                                            </div>
                                        }
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </Content>
                </DialogTemplates>
                <DialogEvents Closed="@OrdenFabricacionClose"></DialogEvents>
                <DialogButtons>
                    <DialogButton Type="Syncfusion.Blazor.Popups.ButtonType.Button" IconCss="fa fa-save" Content="Guardar" CssClass="btn btn-sm btn-info" OnClick="@OrdenFabricacionOk" />
                    <DialogButton Type="Syncfusion.Blazor.Popups.ButtonType.Button" IconCss="fa fa-window-close" Content="Cancelar" CssClass="btn btn-sm btn-info" OnClick="@OrdenFabricacionClose" />
                </DialogButtons>
            </SfDialog>
        </div>
    }

    @*DIALOG SCRAP*@
    @if (isScrapDialogVisible && ordenFabricacion != null && dbCarga != null && dbScrap != null)
    {
        <div id="targetPreguntaFoto" class="cssScrapDialog">
            <SfDialog Target="#targetPreguntaFoto" Width="90%" Height="35%" CssClass="" IsModal="false" ShowCloseIcon="true"
                      CloseOnEscape="true"
                      @bind-Visible="@isScrapDialogVisible">
                <DialogTemplates>
                    <Header><div class="e-dlg-header-titulo">Seleccione Scrap</div></Header>
                    <Content>
                        <SfListView @ref="@listViewScrap" DataSource="@dbScrap" TValue="ModeloGenericoIntString">
                            <ListViewFieldSettings Id="Id" Text="Texto" TValue="ModeloGenericoIntString" />
                            <ListViewTemplates TValue="ModeloGenericoIntString">
                                <Template>
                                    @{
                                        ModeloGenericoIntString xContext = (ModeloGenericoIntString)context;
                                        <div class="e-list-wrapper e-list-multi-line e-list-avatar" @onclick="(e => Scrap_Selection(xContext))">
                                            <span class="e-list-content">@xContext.ID</span>
                                            <span class="e-list-content">&nbsp;&nbsp;</span>
                                            <span class="e-list-content">@xContext.TEXTO</span>
                                        </div>
                                    }
                                </Template>
                            </ListViewTemplates>
                        </SfListView>
                        <br />
                        <span style="color:chocolate;margin-top:20px">@scrapSeleccionadoMensaje</span>
                    </Content>
                </DialogTemplates>
                <DialogEvents Closed="@DialogScrapClose"></DialogEvents>
                <DialogButtons>
                    <DialogButton Content="Aceptar" IsPrimary="true" OnClick="@DialogScrapOk" />
                    <DialogButton Content="Cancelar" OnClick="@DialogScrapClose" />
                </DialogButtons>
            </SfDialog>
        </div>
    }

</div>


<ConfirmacionDialog @ref="@confirmacionDescargarPlanoDialog" OnConfirm="@(async ()=> await DescrgarPlano())">
    <HeaderTempalte><p>Plano Pdf</p> <hr /></HeaderTempalte>
    <ContentTemplate>Confirma Descargar Plano?</ContentTemplate>
</ConfirmacionDialog>

@*DIALOG EVENTO*@
@if (isEventoDialogVisible)
{
    <div class="cssOrdenFabricacionDialog">
        <SfDialog Target="#targetPreguntaFoto" Width="80%" Height="85%" CssClass="" IsModal="false" ShowCloseIcon="true"
                  CloseOnEscape="true"
                  @bind-Visible="@isEventoDialogVisible">
            <DialogTemplates>
                <Content>
                    <SupplyChain.Client.Pages.CDM.Noconformidades vieneOF="ordenNumero"></SupplyChain.Client.Pages.CDM.Noconformidades>
                </Content>
            </DialogTemplates>
            <DialogEvents OnClose="@DialogEventoClose"></DialogEvents>
        </SfDialog>
    </div>
}


<style>

    /*    table {
            display: block;
            height: 500px;
            overflow-y: scroll;
        }*/

    .titulo {
        font-weight: bold;
        color: dodgerblue;
        margin-top: 20px;
    }

    .CargaButtonClass {
        cursor: pointer;
        padding: 0px;
        padding-left: 0px;
        padding-right: 0px;
        width: 100%;
        height: 26px;
        border-width: 0px;
        border-right-width: thin;
        border-right-style: solid;
        border-right-color: whitesmoke;
        font-size: 18px;
        font-weight: bold;
    }

    .CargaButtonClassFirstFirme {
        border-width: 2px;
        border-color: lightseagreen;
        font-size: 18px;
        font-weight: bold;
    }

    .CargaButtonClassBuscarOrden {
        border-width: 5px;
        border-color: black;
        font-size: 18px;
        font-weight: bold;
    }

    .CargaRowClass {
        padding: 0px;
        padding-left: 0px;
        padding-right: 0px;
        height: 35px;
        border-width: 0px;
    }

    .CargaCellClass {
        width: 100%;
        width: 60px;
        padding: 0px;
        padding-left: 0px;
        padding-right: 0px;
    }

    .CargaCeldaBuscarOrden {
        color: deepskyblue !important;
        background: white !important;
    }

    .CargaHyperLink {
        cursor: pointer;
        margin-right: 20px;
        text-decoration: none;
        font-size: small;
        color: black;
    }

    .cssOrdenFabricacionDialog {
        position: fixed;
        top: 5%;
        left: 5%;
        min-width: 1200px;
        min-height: 580px;
        max-width: 90%;
        margin-top: auto;
        margin-right: auto;
        margin-left: auto;
        margin-bottom: auto;
        left: 50px !important;
        top: 0px !important;
    }

    .cssScrapDialog {
        position: fixed;
        top: 10%;
        left: 30%;
        width: 40%;
        height: 80%;
        max-width: 40%;
        margin-top: auto;
        margin-right: auto;
        margin-left: auto;
        margin-bottom: auto;
    }

    .form-group {
        margin-bottom: 0rem;
    }

    label {
        display: inline-block;
        margin-bottom: 0rem;
    }

    hr {
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
        border: 0;
        border-top: 1px solid rgba(0,0,0,.1);
    }

    .tooltiptext {
        visibility: hidden;
        background-color: black;
        color: #fff;
        text-align: center;
        padding: 5px 0;
        border-radius: 6px;
        position: fixed;
        z-index: 1;
    }

    #ButtonHover:hover .tooltiptext {
        visibility: visible;
    }

    .e-btn.e-flat, .e-css.e-btn.e-flat {
        background-color: #398bf7;
        border-color: #fafafa;
        box-shadow: none;
        color: #fafafa;
    }


    .e-tooltip-wrap.e-popup {
        border: 2px solid #000;
        background-color: black;
        color: #fff !important;
        text-align: center;
        padding: 5px 0;
        border-radius: 6px;
    }

    .e-tooltip-wrap .e-tip-content {
        color: red;
        font-size: 12px;
        line-height: 20px;
    }
</style>
